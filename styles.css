/* -----------------------------------------------------------------------------
Focused Writing for Obsidian
A distraction-free writing mode plugin with an iA Writer-like feel.

UI hiding inspired by Zen (https://github.com/Maxymillion/zen) by @Maxymillion
Typewriter scrolling adapted from Typewriter Mode by Davis Riedel
----------------------------------------------------------------------------- */

/* =============================================================================
   UI HIDING
   ============================================================================= */

/* Hide Ribbon */
body.focused-writing--hide-ribbon .workspace-ribbon.mod-left {
	display: none;
}

body.focused-writing--hide-ribbon .workspace-ribbon.mod-right {
	visibility: hidden;
	position: absolute;
}

body.focused-writing--hide-ribbon .workspace-split.mod-right-split {
	margin-right: 0;
}

body.focused-writing--hide-ribbon .workspace-split.mod-left-split {
	margin-left: 0;
}

/* macOS specific ribbon adjustments */
body.focused-writing--hide-ribbon.mod-macos.is-hidden-frameless:not(.is-fullscreen):not(.is-popout-window) .workspace-tabs.mod-top-left-space .workspace-tab-header-container {
	padding-left: var(--frame-left-space);
}

/* Hide Tabs */
body.focused-writing--hide-tabs .workspace-split.mod-vertical.mod-root .workspace-tab-header-container {
	background: transparent;
	border-color: transparent;
	box-shadow: none;
}

body.focused-writing--hide-tabs .workspace-split.mod-vertical.mod-root .workspace-tab-header-container > div {
	visibility: hidden;
}

/* Hide Status Bar */
body.focused-writing--hide-status-bar .status-bar {
	display: none;
}

/* Hide File Header */
body.focused-writing--hide-file-header .workspace-split.mod-vertical.mod-root .view-header {
	display: none;
}

/* Hide Title (inline title) */
body.focused-writing--hide-title .inline-title {
	display: none;
}

/* Hide Left Sidebar */
body.focused-writing--hide-side-dock-left .is-left-sidedock-open .workspace-split.mod-horizontal.mod-left-split {
	width: 0 !important;
}

body.focused-writing--hide-side-dock-left .sidebar-toggle-button.mod-left {
	display: none;
}

/* Hide Right Sidebar */
body.focused-writing--hide-side-dock-right .is-right-sidedock-open .workspace-split.mod-horizontal.mod-right-split {
	width: 0 !important;
}

body.focused-writing--hide-side-dock-right .sidebar-toggle-button.mod-right {
	display: none;
}

/* =============================================================================
   TEXT STYLING (Font Size, Font Family, Uniform Text)
   ============================================================================= */

body.focused-writing-enabled .cm-editor .cm-content {
	font-size: var(--focused-writing-font-size, 24px);
	font-family: var(--focused-writing-font-family, Menlo, monospace);
	line-height: 1.6;
}

/* Uniform text size - make headers same size but keep them bold */
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .HyperMD-header,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .HyperMD-header-1,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .HyperMD-header-2,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .HyperMD-header-3,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .HyperMD-header-4,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .HyperMD-header-5,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .HyperMD-header-6 {
	font-size: var(--focused-writing-font-size, 24px) !important;
	font-weight: bold;
}

body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .cm-header,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .cm-header-1,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .cm-header-2,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .cm-header-3,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .cm-header-4,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .cm-header-5,
body.focused-writing-enabled.focused-writing--uniform-text .cm-editor .cm-content .cm-header-6 {
	font-size: var(--focused-writing-font-size, 24px) !important;
	font-weight: bold;
}

/* Inline title (page title) - uniform size, bold */
body.focused-writing-enabled.focused-writing--uniform-text .inline-title {
	font-size: var(--focused-writing-font-size, 24px) !important;
	font-weight: bold;
	font-family: var(--focused-writing-font-family, Menlo, monospace);
}

/* =============================================================================
   MAX CHARACTERS PER LINE
   Override Obsidian's native "Readable line length" setting
   ============================================================================= */

/* Override Obsidian's --file-line-width variable */
body.focused-writing-enabled.focused-writing--max-chars {
	--file-line-width: var(--focused-writing-max-chars, 80ch) !important;
}

/* Override readable line width on the editor content */
body.focused-writing-enabled.focused-writing--max-chars .cm-editor .cm-content {
	max-width: var(--focused-writing-max-chars, 80ch) !important;
	margin-left: auto;
	margin-right: auto;
}

body.focused-writing-enabled.focused-writing--max-chars .cm-editor .cm-line {
	max-width: var(--focused-writing-max-chars, 80ch) !important;
}

/* Override when Obsidian's readable line width is enabled */
body.focused-writing-enabled.focused-writing--max-chars.is-readable-line-width .cm-editor .cm-content,
body.focused-writing-enabled.focused-writing--max-chars .is-readable-line-width .cm-editor .cm-content {
	max-width: var(--focused-writing-max-chars, 80ch) !important;
}

body.focused-writing-enabled.focused-writing--max-chars.is-readable-line-width .cm-editor .cm-sizer,
body.focused-writing-enabled.focused-writing--max-chars .is-readable-line-width .cm-editor .cm-sizer {
	max-width: var(--focused-writing-max-chars, 80ch) !important;
	margin-left: auto;
	margin-right: auto;
}

/* Center the inline title as well */
body.focused-writing-enabled.focused-writing--max-chars .inline-title {
	max-width: var(--focused-writing-max-chars, 80ch) !important;
	margin-left: auto;
	margin-right: auto;
}

/* =============================================================================
   SENTENCE FADING
   ============================================================================= */

/* Dim all lines when focused writing is active */
body.focused-writing-enabled .cm-editor .cm-line {
	opacity: var(--focused-writing-dimmed-opacity, 0.25);
}

/* Active line stays fully visible */
body.focused-writing-enabled .cm-editor .cm-line.cm-active {
	opacity: 1;
}

/* Within the active line, dim inactive parts (outside active sentence) */
body.focused-writing-enabled .cm-editor .cm-line.cm-active .focused-writing-inactive {
	opacity: var(--focused-writing-dimmed-opacity, 0.25);
}

/* Active sentence is fully visible */
body.focused-writing-enabled .cm-editor .cm-line.cm-active .focused-writing-active-sentence {
	opacity: 1;
}
